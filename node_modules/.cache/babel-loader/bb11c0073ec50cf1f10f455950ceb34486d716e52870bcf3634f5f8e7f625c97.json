{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.merge = exports.graphql = void 0;\nvar apollo_utilities_1 = require(\"apollo-utilities\");\nfunction graphql(resolver, document, rootValue, contextValue, variableValues, execOptions) {\n  if (variableValues === void 0) {\n    variableValues = {};\n  }\n  if (execOptions === void 0) {\n    execOptions = {};\n  }\n  var mainDefinition = (0, apollo_utilities_1.getMainDefinition)(document);\n  var fragments = (0, apollo_utilities_1.getFragmentDefinitions)(document);\n  var fragmentMap = (0, apollo_utilities_1.createFragmentMap)(fragments);\n  var resultMapper = execOptions.resultMapper;\n  var fragmentMatcher = execOptions.fragmentMatcher || function () {\n    return true;\n  };\n  var execContext = {\n    fragmentMap: fragmentMap,\n    contextValue: contextValue,\n    variableValues: variableValues,\n    resultMapper: resultMapper,\n    resolver: resolver,\n    fragmentMatcher: fragmentMatcher\n  };\n  return executeSelectionSet(mainDefinition.selectionSet, rootValue, execContext);\n}\nexports.graphql = graphql;\nfunction executeSelectionSet(selectionSet, rootValue, execContext) {\n  var fragmentMap = execContext.fragmentMap,\n    contextValue = execContext.contextValue,\n    variables = execContext.variableValues;\n  var result = {};\n  selectionSet.selections.forEach(function (selection) {\n    if (variables && !(0, apollo_utilities_1.shouldInclude)(selection, variables)) {\n      return;\n    }\n    if ((0, apollo_utilities_1.isField)(selection)) {\n      var fieldResult = executeField(selection, rootValue, execContext);\n      var resultFieldKey = (0, apollo_utilities_1.resultKeyNameFromField)(selection);\n      if (fieldResult !== undefined) {\n        if (result[resultFieldKey] === undefined) {\n          result[resultFieldKey] = fieldResult;\n        } else {\n          merge(result[resultFieldKey], fieldResult);\n        }\n      }\n    } else {\n      var fragment = void 0;\n      if ((0, apollo_utilities_1.isInlineFragment)(selection)) {\n        fragment = selection;\n      } else {\n        fragment = fragmentMap[selection.name.value];\n        if (!fragment) {\n          throw new Error(\"No fragment named \".concat(selection.name.value));\n        }\n      }\n      var typeCondition = fragment.typeCondition.name.value;\n      if (execContext.fragmentMatcher(rootValue, typeCondition, contextValue)) {\n        var fragmentResult = executeSelectionSet(fragment.selectionSet, rootValue, execContext);\n        merge(result, fragmentResult);\n      }\n    }\n  });\n  if (execContext.resultMapper) {\n    return execContext.resultMapper(result, rootValue);\n  }\n  return result;\n}\nfunction executeField(field, rootValue, execContext) {\n  var variables = execContext.variableValues,\n    contextValue = execContext.contextValue,\n    resolver = execContext.resolver;\n  var fieldName = field.name.value;\n  var args = (0, apollo_utilities_1.argumentsObjectFromField)(field, variables);\n  var info = {\n    isLeaf: !field.selectionSet,\n    resultKey: (0, apollo_utilities_1.resultKeyNameFromField)(field),\n    directives: (0, apollo_utilities_1.getDirectiveInfoFromField)(field, variables),\n    field: field\n  };\n  var result = resolver(fieldName, rootValue, args, contextValue, info);\n  if (!field.selectionSet) {\n    return result;\n  }\n  if (result == null) {\n    return result;\n  }\n  if (Array.isArray(result)) {\n    return executeSubSelectedArray(field, result, execContext);\n  }\n  return executeSelectionSet(field.selectionSet, result, execContext);\n}\nfunction executeSubSelectedArray(field, result, execContext) {\n  return result.map(function (item) {\n    if (item === null) {\n      return null;\n    }\n    if (Array.isArray(item)) {\n      return executeSubSelectedArray(field, item, execContext);\n    }\n    return executeSelectionSet(field.selectionSet, item, execContext);\n  });\n}\nvar hasOwn = Object.prototype.hasOwnProperty;\nfunction merge(dest, src) {\n  if (src !== null && typeof src === 'object') {\n    Object.keys(src).forEach(function (key) {\n      var srcVal = src[key];\n      if (!hasOwn.call(dest, key)) {\n        dest[key] = srcVal;\n      } else {\n        merge(dest[key], srcVal);\n      }\n    });\n  }\n}\nexports.merge = merge;","map":{"version":3,"names":["apollo_utilities_1","require","graphql","resolver","document","rootValue","contextValue","variableValues","execOptions","mainDefinition","getMainDefinition","fragments","getFragmentDefinitions","fragmentMap","createFragmentMap","resultMapper","fragmentMatcher","execContext","executeSelectionSet","selectionSet","exports","variables","result","selections","forEach","selection","shouldInclude","isField","fieldResult","executeField","resultFieldKey","resultKeyNameFromField","undefined","merge","fragment","isInlineFragment","name","value","Error","concat","typeCondition","fragmentResult","field","fieldName","args","argumentsObjectFromField","info","isLeaf","resultKey","directives","getDirectiveInfoFromField","Array","isArray","executeSubSelectedArray","map","item","hasOwn","Object","prototype","hasOwnProperty","dest","src","keys","key","srcVal","call"],"sources":["../src/graphql.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}