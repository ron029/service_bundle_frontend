{"remainingRequest":"/home/bonifacio/code/service_bundle_frontend/node_modules/@vue/cli-service/lib/config/vue-loader-v15-resolve-compat/vue-loader.js??vue-loader-options!/home/bonifacio/code/service_bundle_frontend/src/components/ServiceListCustomer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/bonifacio/code/service_bundle_frontend/src/components/ServiceListCustomer.vue","mtime":1698026528102},{"path":"/home/bonifacio/code/service_bundle_frontend/node_modules/babel-loader/lib/index.js","mtime":1692833949708},{"path":"/home/bonifacio/code/service_bundle_frontend/node_modules/cache-loader/dist/cjs.js","mtime":1692838039149},{"path":"/home/bonifacio/code/service_bundle_frontend/node_modules/@vue/cli-service/lib/config/vue-loader-v15-resolve-compat/vue-loader.js","mtime":1692833961693}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHJlcXVpcmVkLCBoZWxwZXJzIH0gZnJvbSAnQHZ1ZWxpZGF0ZS92YWxpZGF0b3JzJzsKaW1wb3J0IHsgdXNlVnVlbGlkYXRlIH0gZnJvbSAnQHZ1ZWxpZGF0ZS9jb3JlJwppbXBvcnQgTW9kYWxUZXN0IGZyb20gJ0AvY29tcG9uZW50cy9Nb2RhbFRlc3QudnVlJzsKaW1wb3J0IERhdGVwaWNrZXIgZnJvbSAndnVlanMtZGF0ZXBpY2tlcic7CmltcG9ydCBWdWUyVGltZXBpY2tlciBmcm9tICd2dWUyLXRpbWVwaWNrZXInOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NlcnZpY2VMaXN0Q3VzdG9tZXInLAogIHNldHVwICgpIHsgcmV0dXJuIHsgdiQ6IHVzZVZ1ZWxpZGF0ZSgpIH0gfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VydmljZV9ieV9jYXRlZ29yeTogW10sCiAgICAgIG1vZGFsSWQ6ICdjdXN0b21Nb2RhbCcsCiAgICAgIGF2YWlsYWJsZV90aW1lc2xvdDogW10sCiAgICAgIGR1cmF0aW9uOiAwLAogICAgICBkYXRlOiAnJywKICAgICAgb3Blbl90aW1lOiBmYWxzZSwKICAgICAgbWluVGltZTogMCwKICAgICAgbWF4VGltZTogMCwKICAgICAgdGltZTogJycsCiAgICAgIGNvbnZlcnRlZFRpbWU6ICcnLAogICAgICBzZXJ2aWNlX2lkOiAnJywKICAgICAgc2VydmljZTogW10sCiAgICAgIHNsb3Q6IDAsCiAgICAgIGVycl9tZXNzYWdlOiAnJywKICAgICAgZXJyX25vdGlmOiBmYWxzZSwKICAgICAgZGF0ZV9jaGVja2VkOiBmYWxzZSwKICAgICAgY2FsZW5kYXI6IHRydWUsCiAgICAgIHNob3dDYWxlbmRhckluZGV4OiAwLAogICAgICBkaXNwbGF5U2VydmljZTogJycsCiAgICB9CiAgfSwKICB2YWxpZGF0aW9ucygpIHsKICAgIGNvbnN0IG1pbl90aW1lID0gdmFsdWUgPT4gewogICAgICBjb25zdCBzZWxlY3RlZFRpbWUgPSBuZXcgRGF0ZShgMTk3MC0wMS0wMVQke3RoaXMuY29udmVydFRvMjRIb3VyRm9ybWF0KHZhbHVlKX1gKTsKICAgICAgY29uc29sZS5sb2coJ21pbl90aW1lIHZhbDogJywgdmFsdWUsIHRoaXMubWluVGltZSkKICAgICAgY29uc3QgbWludGltZSA9IG5ldyBEYXRlKGAxOTcwLTAxLTAxVCR7dGhpcy5jb252ZXJ0VG8yNEhvdXJGb3JtYXQodGhpcy5taW5UaW1lKX1gKTsKICAgICAgY29uc29sZS5sb2coJ21pbl90aW1lIHJlc3VsdDogJywgc2VsZWN0ZWRUaW1lID49IG1pbnRpbWUpCiAgICAgIHJldHVybiBzZWxlY3RlZFRpbWUgPj0gbWludGltZTsKICAgIH07CiAgICBjb25zdCBtYXhfdGltZSA9IHZhbHVlID0+IHsKICAgICAgY29uc3Qgc2VsZWN0ZWRUaW1lID0gbmV3IERhdGUoYDE5NzAtMDEtMDFUJHt0aGlzLmNvbnZlcnRUbzI0SG91ckZvcm1hdCh2YWx1ZSl9YCk7CiAgICAgIGNvbnNvbGUubG9nKCdtYXhfdGltZSB2YWw6ICcsIHZhbHVlLCB0aGlzLm1heFRpbWUpCiAgICAgIGNvbnN0IG1heHRpbWUgPSBuZXcgRGF0ZShgMTk3MC0wMS0wMVQke3RoaXMuY29udmVydFRvMjRIb3VyRm9ybWF0KHRoaXMubWF4VGltZSl9YCk7CiAgICAgIGNvbnNvbGUubG9nKCdtYXhfdGltZSByZXN1bHQ6ICcsIHNlbGVjdGVkVGltZSA8PSBtYXh0aW1lKQogICAgICByZXR1cm4gc2VsZWN0ZWRUaW1lIDw9IG1heHRpbWU7CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgdGltZTogewogICAgICAgIHJlcXVpcmVkLAogICAgICAgIC8vIHZhbGlkVGltZSh2YWx1ZSkgewogICAgICAgIC8vICAgY29uc3QgdGltZVBhdHRlcm4gPSAvXihbMDFdXGR8MlswLTNdKTooWzAtNV1cZCkkLzsKICAgICAgICAvLyAgIHJldHVybiB0aW1lUGF0dGVybi50ZXN0KHZhbHVlKTsKICAgICAgICAvLyB9LAogICAgICAgIG1pbl90aW1lOiBoZWxwZXJzLndpdGhNZXNzYWdlKCdUaGUgbWluIHRpbWUgbXVzdCBiZSAnICsgdGhpcy5taW5UaW1lLCBtaW5fdGltZSkgLCAgICAgCiAgICAgICAgbWF4X3RpbWU6IGhlbHBlcnMud2l0aE1lc3NhZ2UoJ1RoZSBtYXggdGltZSBtdXN0IGJlICcgKyB0aGlzLm1heFRpbWUsIG1heF90aW1lKSAsICAgICAKICAgICAgfSwKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIERhdGVwaWNrZXIsCiAgICBNb2RhbFRlc3QsCiAgICBWdWUyVGltZXBpY2tlciwKICB9LAogIG1ldGhvZHM6IHsKICAgIHNob3dTZXJ2aWNlKGl0ZW0pIHsKICAgICAgY29uc29sZS5sb2coJ3Nob3dTZXJ2aWNlJykKICAgICAgdGhpcy5hdmFpbGFibGVfdGltZXNsb3QgPSAwCiAgICAgIHRoaXMudGltZSA9ICcnCiAgICAgIHRoaXMubWF4VGltZSA9ICcnCiAgICAgIHRoaXMubWluVGltZSA9ICcnCiAgICAgIHRoaXMuZGlzcGxheVNlcnZpY2UgPSBpdGVtLm5hbWUKICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoCiAgICAgICAge30sCiAgICAgICAgbnVsbCwKICAgICAgICB0aGlzLiRyb3V0ZS5wYXRoICsgJy9zZXJ2aWNlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGl0ZW0uaWQpCiAgICAgICkKICAgIH0sCiAgICBzaG93Q2FsZW5kYXIoaW5kZXgpIHsKICAgICAgdGhpcy5jYWxlbmRhciA9IHRydWU7CiAgICAgIHRoaXMuc2hvd0NhbGVuZGFySW5kZXggPSBpbmRleDsKICAgICAgY29uc29sZS5sb2coJ3Nob3dDYWxlbmRhcicsIGluZGV4KTsKICAgIH0sCiAgICBoaWRlQ2FsZW5kYXIoKSB7CiAgICAgIHRoaXMuY2FsZW5kYXIgPSBmYWxzZTsKICAgICAgY29uc29sZS5sb2coJ2hpZGUgY2FsZW5kYXInKQogICAgfSwKICAgIGlzVGltZUluRm9ybWF0KCkgewogICAgICBjb25zdCB0aW1lUGF0dGVybiA9IC9eKDBbMS05XXwxWzAtMl0pOlswLTVdWzAtOV06WzAtNV1bMC05XSAoQU18UE0pJC87CiAgICAgIHJldHVybiB0aW1lUGF0dGVybi50ZXN0KHRoaXMudGltZSk7CiAgICB9LAogICAgYXN5bmMgY3JlYXRlX2NhcnRfaXRlbSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBkYXRlID0gdGhpcy5kYXRlOwogICAgICAgIGNvbnN0IHNlcnZpY2VfaWQgPSB0aGlzLnNlcnZpY2UuaWQ7CiAgICAgICAgY29uc3QgdGltZSA9IHRoaXMudGltZTsKICAgICAgICBjb25zb2xlLmxvZygnc2VydmljZWlkIGlzICcsIHNlcnZpY2VfaWQpCiAgICAgICAgY29uc29sZS5sb2coJ2RhdGUgJywgZGF0ZSk7CiAgICAgICAgY29uc29sZS5sb2coJ3RpbWUgJywgdGltZSkKCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRhcG9sbG8ubXV0YXRlKHsKICAgICAgICAgIG11dGF0aW9uOiByZXF1aXJlKCdAL2dyYXBocWwvQ2FydEl0ZW1DcmVhdGUuZ3FsJyksCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgc2VydmljZUlkOiBzZXJ2aWNlX2lkLAogICAgICAgICAgICBkYXRlOiBkYXRlLAogICAgICAgICAgICB0aW1lOiB0aW1lLAogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygncmVzcG9uc2UgZnJvbSBzZXJ2ZXIgY3JlYXRlIGNhcnQgaXRlbScscmVzcG9uc2UpOwogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNyZWF0ZUNhcnRJdGVtLmVycm9ycy5sZW5ndGggPCAxKSB7CiAgICAgICAgICBhbGVydCgnU1VDQ0VTUyAhJykKICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5wdXNoKCcvY2FydCcpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IocmVzcG9uc2UuZGF0YS5jcmVhdGVDYXJ0SXRlbS5lcnJvcnNbMF0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjcmVhdGVfY2FydF9pdGVtOicsIGVycm9yKTsKICAgICAgICAvLyBIYW5kbGUgdGhlIGVycm9yIGhlcmUsIGUuZy4sIHNob3cgYW4gZXJyb3IgbWVzc2FnZSB0byB0aGUgdXNlci4KICAgICAgfQogICAgfSwKICAgIGhhbmRsZUVycm9yKGVyck1zZykgewogICAgICB0aGlzLmVycl9tZXNzYWdlID0gZXJyTXNnOwogICAgICB0aGlzLmVycl9ub3RpZiA9IHRydWU7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lcnJfbm90aWYgPSBmYWxzZSwgMTAwMDApOwogICAgfSwKICAgIG9uVGltZVNlbGVjdGVkKCkgewogICAgICBpZiAodGhpcy50aW1lID4gdGhpcy5tYXhUaW1lKSB0aGlzLnRpbWUgPSB0aGlzLm1heFRpbWU7CiAgICAgIHRoaXMudGltZSA9IHRoaXMuY29udmVydFRvMTJIb3VyRm9ybWF0KHRoaXMudGltZSk7CiAgICB9LAogICAgY2hhbmdlVGltZSgpIHsgdGhpcy50aW1lID0gJycgfSwKICAgIGNvbnZlcnRUbzI0SG91ckZvcm1hdCh0aW1lMTIpIHsKICAgICAgLy8gU3BsaXQgdGhlIGlucHV0IHRpbWUgaW50byBob3VycywgbWludXRlcywgYW5kIEFNL1BNIHBhcnRzCiAgICAgIGNvbnN0IFt0aW1lUGFydCwgYW1wbV0gPSB0aW1lMTIuc3BsaXQoJyAnKTsKICAgICAgY29uc3QgW2hvdXJzLCBtaW51dGVzLCBzZWNvbmRzXSA9IHRpbWVQYXJ0LnNwbGl0KCc6Jyk7CgogICAgICAvLyBQYXJzZSB0aGUgaG91cnMgYXMgYW4gaW50ZWdlcgogICAgICBsZXQgY29udmVydGVkSG91cnMgPSBwYXJzZUludChob3VycywgMTApOwoKICAgICAgLy8gQWRqdXN0IHRoZSBob3VycyBiYXNlZCBvbiBBTSBvciBQTQogICAgICBpZiAoYW1wbS50b1VwcGVyQ2FzZSgpID09PSAnUE0nICYmIGNvbnZlcnRlZEhvdXJzICE9PSAxMikgewogICAgICAgIGNvbnZlcnRlZEhvdXJzICs9IDEyOwogICAgICB9IGVsc2UgaWYgKGFtcG0udG9VcHBlckNhc2UoKSA9PT0gJ0FNJyAmJiBjb252ZXJ0ZWRIb3VycyA9PT0gMTIpIHsKICAgICAgICBjb252ZXJ0ZWRIb3VycyA9IDA7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIHRoZSAyNC1ob3VyIGZvcm1hdCB0aW1lIHN0cmluZwogICAgICBjb25zdCBjb252ZXJ0ZWRUaW1lID0gYCR7U3RyaW5nKGNvbnZlcnRlZEhvdXJzKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXN9OiR7c2Vjb25kc31gOwoKICAgICAgcmV0dXJuIGNvbnZlcnRlZFRpbWU7CiAgICB9LAogICAgY29udmVydFRvMTJIb3VyRm9ybWF0KHRpbWUyNCkgewogICAgICBjb25zdCBbaG91cnMsIG1pbnV0ZXNdID0gdGltZTI0LnNwbGl0KCI6Iik7CiAgICAgIGxldCBhbXBtID0gIkFNIjsKICAgICAgbGV0IGNvbnZlcnRlZEhvdXJzID0gcGFyc2VJbnQoaG91cnMsIDEwKTsKICAgICAgaWYgKGNvbnZlcnRlZEhvdXJzID49IDEyKSB7CiAgICAgICAgYW1wbSA9ICJQTSI7CiAgICAgICAgaWYgKGNvbnZlcnRlZEhvdXJzID4gMTIpIHsKICAgICAgICAgIGNvbnZlcnRlZEhvdXJzIC09IDEyOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjb252ZXJ0ZWRIb3VycyA9PT0gMCkgewogICAgICAgIGNvbnZlcnRlZEhvdXJzID0gMTI7IC8vIE1pZG5pZ2h0IGluIDEyLWhvdXIgZm9ybWF0IGlzIDEyOjAwIEFNCiAgICAgIH0KICAgICAgY29uc3QgbmV3X3RpbWUgPSBgJHtTdHJpbmcoY29udmVydGVkSG91cnMpLnBhZFN0YXJ0KDIsICIwIil9OiR7bWludXRlc306MDAgJHthbXBtfWA7CiAgICAgIHJldHVybiBuZXdfdGltZTsKICAgIH0sCiAgICBnZXRDdXJyZW50SG91cigpIHsKICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICBjb25zdCBjdXJyZW50SG91ciA9IGN1cnJlbnREYXRlLmdldEhvdXJzKCk7CgogICAgICByZXR1cm4gcGFyc2VJbnQoY3VycmVudEhvdXIpOwogICAgfSwKICAgIHN0YXJ0SG91cigpewogICAgICBpZiAodGhpcy5kYXRlID09IHRoaXMuZGF0ZVRvZGF5KCkpIHsKICAgICAgICBjb25zdCBob3VyID0gdGhpcy5nZXRDdXJyZW50SG91cigpOwogICAgICAgIGlmIChob3VyID49IHBhcnNlSW50KHRoaXMubWluVGltZS5zcGxpdCgiOiIpWzBdLCAxMCkpIHJldHVybiBob3VyICsgMTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5taW5UaW1lLnNwbGl0KCI6IilbMF0sIDEwKTsKICAgICAgfQogICAgfSwKICAgIGVuZEhvdXIoKXsKICAgICAgcmV0dXJuIHBhcnNlSW50KHRoaXMubWF4VGltZS5zcGxpdCgiOiIpWzBdLCAxMCk7CiAgICB9LAogICAgYXN5bmMgc3VibWl0Rm9ybSgpIHsKICAgICAgdGhpcy5taW5UaW1lID0gdGhpcy5jb252ZXJ0VG8xMkhvdXJGb3JtYXQodGhpcy5taW5UaW1lKTsKICAgICAgdGhpcy5tYXhUaW1lID0gdGhpcy5jb252ZXJ0VG8xMkhvdXJGb3JtYXQodGhpcy5tYXhUaW1lKTsKICAgICAgdGhpcy52JC50aW1lLiR0b3VjaCgpOwogICAgICBpZiAodGhpcy52JC4kZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKTsKICAgICAgICBjb25zb2xlLmxvZygnZXJyb3IgdGltZTogJywgdGhpcy50aW1lKTsKICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Jtc2c6ICcsIHRoaXMudiQuJGVycm9ycyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVfY2FydF9pdGVtKCk7CiAgICAgIH0KICAgICAgdGhpcy5taW5UaW1lID0gdGhpcy5jb252ZXJ0VG8yNEhvdXJGb3JtYXQodGhpcy5taW5UaW1lKTsKICAgICAgdGhpcy5tYXhUaW1lID0gdGhpcy5jb252ZXJ0VG8yNEhvdXJGb3JtYXQodGhpcy5tYXhUaW1lKTsKICAgICAgY29uc3QgdGltZTI0ID0gdGhpcy50aW1lLnRyaW0oKTsKICAgICAgaWYgKHRpbWUyNC5tYXRjaCgvXlxkezJ9OlxkezJ9JC8pKSB7CiAgICAgICAgdGhpcy5jb252ZXJ0ZWRUaW1lID0gdGhpcy5jb252ZXJ0VG8xMkhvdXJGb3JtYXQodGltZTI0KTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygnVVBEQVRFRCBUSU1FOiAnLHRoaXMuY29udmVydGVkVGltZSk7CiAgICB9LAogICAgaGFuZGxlRGF0ZVNlbGVjdGVkKHBhcmFtcywgaXRlbSkgewogICAgICBsZXQgcmFuZ2UgPSBpdGVtLnRpbWVTbG90W3RoaXMuZmluZERhdGVSYW5nZUluZGV4KGl0ZW0udGltZVNsb3QsIHBhcmFtcyldOwogICAgICAgIC8vIGNvbnNvbGUubG9nKCd0aW1lc2xvdCBpbmZvIGlzOiAnLCByYW5nZSk7CiAgICAgIHRoaXMubWluVGltZSA9IHJhbmdlLnN0YXJ0VGltZTsKICAgICAgdGhpcy5tYXhUaW1lID0gcmFuZ2UuZW5kVGltZTsKICAgICAgdGhpcy5kdXJhdGlvbiA9IHJhbmdlLmR1cmF0aW9uOwogICAgICBjb25zb2xlLmxvZygnU0VMRUNURUQgREFURTogJywgcGFyYW1zKQoKICAgICAgbGV0IGJvb2tlZF9jb3VudGVyID0gMDsKICAgICAgZm9yIChsZXQgaT0wOyBpPGl0ZW0uY2FydEl0ZW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZih0aGlzLnRpbWVzdGFtcFRvZGF0ZShwYXJhbXMpID09IGl0ZW0uY2FydEl0ZW1baV0uZGF0ZSkgYm9va2VkX2NvdW50ZXIrKzsKICAgICAgfQogICAgICB0aGlzLnNsb3QgPSByYW5nZS5jYXBhY2l0eSAtIGJvb2tlZF9jb3VudGVyOwogICAgICBjb25zb2xlLmxvZygncmVtYWluaW5nIHNsb3QgZm9yIGRhdGU6ICcsdGhpcy50aW1lc3RhbXBUb2RhdGUocGFyYW1zKSwgJyBpczogJywgdGhpcy5zbG90KQoKICAgICAgY29uc29sZS5sb2coJ3JhbmdlOiAnLHJhbmdlKTsKICAgICAgaWYgKHJhbmdlLmR1cmF0aW9uICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vcGVuX3RpbWUgPSBmYWxzZTsKICAgICAgICB0aGlzLnRpbWUgPSAnJzsKICAgICAgICB0aGlzLmF2YWlsYWJsZV90aW1lc2xvdCA9IHRoaXMuY3JlYXRlQXZhaWxhYmxlVGltZVNsb3QocmFuZ2Uuc3RhcnRUaW1lLCByYW5nZS5lbmRUaW1lLCByYW5nZS5kdXJhdGlvbiwgcmFuZ2UuaW50ZXJ2YWwsIHBhcmFtcywgaXRlbS5jYXJ0SXRlbSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm9wZW5fdGltZSA9IHRydWU7CiAgICAgIH0KICAgICAgLy8gVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgd2hlbiBhIGRhdGUgaXMgc2VsZWN0ZWQKICAgICAgdGhpcy5kYXRlID0gcGFyYW1zOwogICAgICB0aGlzLnNlcnZpY2UgPSBpdGVtOwogICAgICBjb25zb2xlLmxvZygnU2VsZWN0ZWQgZGF0ZTonLCBwYXJhbXMsIGl0ZW0pOwogICAgfSwKICAgIGZpbmREYXRlUmFuZ2VJbmRleChkYXRlUmFuZ2VzLCB0YXJnZXREYXRlKSB7CiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0YXJnZXREYXRlKTsgLy8gQ29udmVydCB0YXJnZXREYXRlIHRvIGEgRGF0ZSBvYmplY3QKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRlUmFuZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgeyBzdGFydERhdGUsIGVuZERhdGUgfSA9IGRhdGVSYW5nZXNbaV07CgogICAgICAgIGlmIChkYXRlID49IG5ldyBEYXRlKHN0YXJ0RGF0ZSkgJiYgZGF0ZSA8PSBuZXcgRGF0ZShlbmREYXRlKSkgewogICAgICAgICAgcmV0dXJuIGk7IC8vIFJldHVybiB0aGUgaW5kZXggaWYgdGhlIGRhdGUgaXMgd2l0aGluIHRoZSByYW5nZQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gLTE7IC8vIFJldHVybiAtMSBpZiB0aGUgZGF0ZSBpcyBub3QgZm91bmQgaW4gYW55IHJhbmdlCiAgICB9LAogICAgZGF0ZVRvZGF5KCkgewogICAgICAvLyBDcmVhdGUgYSBEYXRlIG9iamVjdCB3aXRoIHRoZSBkZXNpcmVkIGRhdGUgKGUuZy4sIHRoZSBjdXJyZW50IGRhdGUpCiAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsKCiAgICAgIC8vIEdldCB0aGUgZGF5LCBtb250aCwgYW5kIHllYXIgY29tcG9uZW50cwogICAgICBjb25zdCBkYXkgPSBjdXJyZW50RGF0ZS5nZXREYXRlKCk7IC8vIDEtMzEKICAgICAgY29uc3QgbW9udGggPSBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMTsgLy8gMC0xMSAoSmFudWFyeSBpcyAwLCBzbyBhZGQgMSkKICAgICAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7IC8vIDQtZGlnaXQgeWVhcgogICAgICBjb25zdCBmb3JtYXR0ZWREYXkgPSBTdHJpbmcoZGF5KS5wYWRTdGFydCgyLCAnMCcpOwogICAgICBjb25zdCBmb3JtYXR0ZWRNb250aCA9IFN0cmluZyhtb250aCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgcmV0dXJuIGAke3llYXJ9LSR7Zm9ybWF0dGVkTW9udGh9LSR7Zm9ybWF0dGVkRGF5fWA7CiAgICB9LAogICAgZm9ybWF0X2RhdGUocGFyYW1zKSB7CiAgICAgIHJldHVybiBwYXJhbXMuZGF0ZQogICAgfSwKICAgIGNyZWF0ZUF2YWlsYWJsZVRpbWVTbG90KHN0YXJ0X3RpbWVfc3RyLCBlbmRfdGltZV9zdHIsIGR1cmF0aW9uLCBpbnRlcnZhbCwgZGF0ZV9zZWxlY3RlZCwgaXRlbSkgewogICAgICBjb25zdCBkYXRlX3NlbGVjdGVkX2Zvcm1hdHRlZCA9IHRoaXMuZm9ybWF0TG9uZ0RhdGUoZGF0ZV9zZWxlY3RlZCk7CiAgICAgIGNvbnN0IGhvdXIgPSB0aGlzLmdldEN1cnJlbnRIb3VyKCk7CiAgICAgIGxldCBlZGl0ZWRfc3RhcnRfdGltZSA9IDA7CiAgICAgIGlmICh0aGlzLmRhdGVUb2RheSgpID09IGRhdGVfc2VsZWN0ZWRfZm9ybWF0dGVkKSB7CiAgICAgICAgY29uc3QgdGltZUNvbXBvbmVudHMgPSBzdGFydF90aW1lX3N0ci5zcGxpdCgiOiIpOwogICAgICAgIC8vIEV4dHJhY3QgdGhlIGhvdXIgY29tcG9uZW50ICh0aGUgZmlyc3QgZWxlbWVudCBhZnRlciBzcGxpdHRpbmcpCiAgICAgICAgY29uc3Qgc2VsZWN0ZWRIb3VyID0gcGFyc2VJbnQodGltZUNvbXBvbmVudHNbMF0sIDEwKTsKICAgICAgICBpZiAoaG91ciA+PSBzZWxlY3RlZEhvdXIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGhvdXIgPj0gc3RhcnRfdGltZV9zdHIsICdIT1VSJykKICAgICAgICAgIGVkaXRlZF9zdGFydF90aW1lID0gYCR7aG91ciArIDF9OjAwOjAwYDsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ2VkaXRlZF9zdGFydF90aW1lJyxlZGl0ZWRfc3RhcnRfdGltZSkKICAgICAgY29uc29sZS5sb2codGhpcy5kYXRlVG9kYXkoKSA9PSBkYXRlX3NlbGVjdGVkX2Zvcm1hdHRlZCx0aGlzLmRhdGVUb2RheSgpLGRhdGVfc2VsZWN0ZWRfZm9ybWF0dGVkKQogICAgICBpZiAoZHVyYXRpb24gPT0gbnVsbCkgZHVyYXRpb24gPSAwOwogICAgICBjb25zdCBhdmFpbGFibGVUaW1lU2xvdHMgPSBbXTsKICAgICAgY29uc3Qgc3RhcnRUaW1lID0gZWRpdGVkX3N0YXJ0X3RpbWUgPT0gMCA/IHRoaXMucGFyc2VUaW1lKHN0YXJ0X3RpbWVfc3RyKSA6IHRoaXMucGFyc2VUaW1lKGVkaXRlZF9zdGFydF90aW1lKTsKICAgICAgY29uc29sZS5sb2coJ3N0YXJ0VGltZTogJywgc3RhcnRUaW1lLCAndGhpcy5wYXJzZVRpbWUoc3RhcnRfdGltZV9zdHIpOiAnLCB0aGlzLnBhcnNlVGltZShzdGFydF90aW1lX3N0cikpCiAgICAgIGNvbnN0IGVuZFRpbWUgPSB0aGlzLnBhcnNlVGltZShlbmRfdGltZV9zdHIpOwoKICAgICAgbGV0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoc3RhcnRUaW1lKTsKCiAgICAgIHdoaWxlIChjdXJyZW50VGltZSA8PSBlbmRUaW1lKSB7CiAgICAgICAgYXZhaWxhYmxlVGltZVNsb3RzLnB1c2goe3ZhbHVlOiB0aGlzLmZvcm1hdFRpbWUoY3VycmVudFRpbWUpLCBsYWJlbDogdGhpcy5mb3JtYXRUaW1lKGN1cnJlbnRUaW1lKX0pOwogICAgICAgIGN1cnJlbnRUaW1lID0gdGhpcy5hZGRNaW51dGVzKGN1cnJlbnRUaW1lLCBkdXJhdGlvbik7IC8vIEluY3JlbWVudCBieSBkdXJhdGlvbiwgbm90IGludGVydmFsCiAgICAgICAgY3VycmVudFRpbWUgPSB0aGlzLmFkZE1pbnV0ZXMoY3VycmVudFRpbWUsIGludGVydmFsKTsgLy8gQWRkIHRoZSByZW1haW5pbmcgaW50ZXJ2YWwKICAgICAgfQogICAgICAKICAgICAgY29uc3QgZGF0ZU9iamVjdCA9IG5ldyBEYXRlKGRhdGVfc2VsZWN0ZWQpOwogICAgICBsZXQgbmV3X3RpbWVzbG90ID0gW107CiAgICAgIC8vIEZvcm1hdCBpdCBhcyBhIGRhdGUgc3RyaW5nCiAgICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSBkYXRlT2JqZWN0LnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTsKICAgICAgZm9yIChsZXQgaT0wOyBpPGl0ZW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoaXRlbVtpXS5kYXRlID09IGZvcm1hdHRlZERhdGUpIHsKICAgICAgICAgIGNvbnN0IGRhdGVPYmplY3QgPSBuZXcgRGF0ZShpdGVtW2ldLnRpbWUpOwoKICAgICAgICAgIC8vIEZvcm1hdCBpdCBhcyBhIHRpbWUgc3RyaW5nCiAgICAgICAgICAvLyBDcmVhdGUgYW4gSW50bC5EYXRlVGltZUZvcm1hdCBvYmplY3Qgd2l0aCB0aGUgZGVzaXJlZCB0aW1lIHpvbmUKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlciA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KCdlbi1VUycsIHsKICAgICAgICAgICAgaG91cjogJ251bWVyaWMnLAogICAgICAgICAgICBtaW51dGU6ICdudW1lcmljJywKICAgICAgICAgICAgc2Vjb25kOiAnbnVtZXJpYycsCiAgICAgICAgICAgIHRpbWVab25lOiAnVVRDJyAvLyBTZXQgdGhlIGRlc2lyZWQgdGltZSB6b25lCiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBGb3JtYXQgdGhlIGRhdGUgb2JqZWN0CiAgICAgICAgICBjb25zdCB0aW1lU3RyaW5nID0gZm9ybWF0dGVyLmZvcm1hdChkYXRlT2JqZWN0KTsKICAgICAgICAgIG5ld190aW1lc2xvdCA9IGF2YWlsYWJsZVRpbWVTbG90cy5maWx0ZXIoaXRlbSA9PiBpdGVtLnZhbHVlICE9PSB0aW1lU3RyaW5nKTsKCiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCdhdmFpbGFibGUgdGltZXNsb3Q6ICcsIGF2YWlsYWJsZVRpbWVTbG90cyk7ICAgICAgCiAgICAgIGNvbnNvbGUubG9nKCduZXdfdGltZXNsb3QnLG5ld190aW1lc2xvdCkKICAgICAgcmV0dXJuIG5ld190aW1lc2xvdC5sZW5ndGggPiAwID8gbmV3X3RpbWVzbG90IDogYXZhaWxhYmxlVGltZVNsb3RzOwogICAgfSwKICAgIHBhcnNlVGltZSh0aW1lU3RyKSB7CiAgICAgIGNvbnN0IFtob3VycywgbWludXRlc10gPSB0aW1lU3RyLnNwbGl0KCc6JykubWFwKE51bWJlcik7CiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICBkYXRlLnNldEhvdXJzKGhvdXJzLCBtaW51dGVzLCAwLCAwKTsKICAgICAgcmV0dXJuIGRhdGU7CiAgICB9LAogICAgZm9ybWF0VGltZSh0aW1lKSB7CiAgICAgIHJldHVybiB0aW1lLnRvTG9jYWxlVGltZVN0cmluZygnZW4tVVMnLCB7IGhvdXIxMjogdHJ1ZSB9KTsKICAgIH0sCiAgICBhZGRNaW51dGVzKHRpbWUsIG1pbnV0ZXMpIHsKICAgICAgcmV0dXJuIG5ldyBEYXRlKHRpbWUuZ2V0VGltZSgpICsgbWludXRlcyAqIDYwMDAwKTsKICAgIH0sCiAgICBoYW5kbGVTY3JvbGwoZXZlbnQpIHsKICAgICAgY29uc3QgZWxlbWVudCA9IGV2ZW50LnRhcmdldDsKICAgICAgY29uc3Qgc2Nyb2xsU3BlZWQgPSAxMDA7IC8vIEFkanVzdCB0aGlzIHZhbHVlIHRvIGNvbnRyb2wgc2Nyb2xsaW5nIHNwZWVkCgogICAgICBpZiAoZXZlbnQuZGVsdGFZICE9PSAwKSB7CiAgICAgICAgLy8gUHJldmVudCB2ZXJ0aWNhbCBzY3JvbGxpbmcKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGhvcml6b250YWwgc2Nyb2xsIGFtb3VudCBiYXNlZCBvbiBzY3JvbGwgc3BlZWQgYW5kIHNjcm9sbCBkaXJlY3Rpb24KICAgICAgICBjb25zdCBzY3JvbGxBbW91bnQgPSBldmVudC5kZWx0YVkgPiAwID8gc2Nyb2xsU3BlZWQgOiAtc2Nyb2xsU3BlZWQ7CgogICAgICAgIC8vIFNjcm9sbCBob3Jpem9udGFsbHkKICAgICAgICBlbGVtZW50LnNjcm9sbExlZnQgKz0gc2Nyb2xsQW1vdW50OwogICAgICB9CiAgICB9LAogICAgb3Blbk1vZGFsKCkgewogICAgICAvLyBVc2UgSmF2YVNjcmlwdCB0byBvcGVuIHRoZSBtb2RhbAogICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMubW9kYWxJZCk7CiAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIG1vZGFsLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTsKCiAgICAgIGNvbnN0IG1vZGFsQmFja2Ryb3AgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgbW9kYWxCYWNrZHJvcC5jbGFzc0xpc3QuYWRkKCdtb2RhbC1iYWNrZHJvcCcsICdmYWRlJywgJ3Nob3cnKTsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbEJhY2tkcm9wKTsKICAgIH0sCiAgICBjbG9zZU1vZGFsKCkgewogICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMubW9kYWxJZCk7CiAgICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgbW9kYWwuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CgogICAgICBjb25zdCBtb2RhbEJhY2tkcm9wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWJhY2tkcm9wJyk7CiAgICAgIG1vZGFsQmFja2Ryb3AucmVtb3ZlKCk7CiAgICB9LAogICAgZ2VuZXJhdGVfc2VydmljZV9saW5rKHNlcnZpY2VfaWQpIHsKICAgICAgcmV0dXJuIGAvc2VydmljZV9jYXRlZ29yaWVzLyR7dGhpcy4kcm91dGUucGFyYW1zLmNhdGVnb3J5SWR9L3NlcnZpY2VzLyR7c2VydmljZV9pZH1gOwogICAgfSwKICAgIGZvcm1hdFRvUEhQKG51bWJlcikgewogICAgICAvLyBDb252ZXJ0IHRoZSBudW1iZXIgdG8gYSBzdHJpbmcgd2l0aCB0d28gZGVjaW1hbCBwbGFjZXMKICAgICAgY29uc3QgZm9ybWF0dGVkTnVtYmVyID0gTnVtYmVyKG51bWJlcikudG9GaXhlZCgyKTsKCiAgICAgIC8vIEFkZCAiUEhQICIgdG8gdGhlIGZvcm1hdHRlZCBudW1iZXIgYW5kIHVzZSBjb21tYXMgYXMgYSB0aG91c2FuZHMgc2VwYXJhdG9yCiAgICAgIGNvbnN0IHJlc3VsdCA9IGBQSFAgJHtmb3JtYXR0ZWROdW1iZXIucmVwbGFjZSgvXEIoPz0oXGR7M30pKyg/IVxkKSkvZywgJywgJyl9YDsKCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9LAogICAgdGltZXN0YW1wVG9kYXRlKHRpbWVzdGFtcCkgewogICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodGltZXN0YW1wKTsKICAgICAgLy8gRXh0cmFjdCB0aGUgY29tcG9uZW50cyAobW9udGgsIGRheSwgeWVhcikKICAgICAgY29uc3QgbW9udGggPSAoZGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOyAvLyBBZGQgMSBiZWNhdXNlIG1vbnRocyBhcmUgemVyby1pbmRleGVkCiAgICAgIGNvbnN0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgY29uc3QgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTsKCiAgICAgIC8vIEZvcm1hdCB0aGUgZGF0ZSBhcyBNTS1ERC1ZWVlZCiAgICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gOwogICAgfSwgCiAgICBnZXREaXNhYmxlZERhdGVzKGRhdGVzKSB7CiAgICAgIGxldCBlbmFibGVkRGF0ZXMgPSBbXTsKICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpOyAvLyBHZXQgdG9kYXkncyBkYXRlIGFzIGEgRGF0ZSBvYmplY3QKCiAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBkYXRlcykgewogICAgICAgIGNvbnN0IGZyb20gPSBuZXcgRGF0ZShkYXRlLnN0YXJ0RGF0ZSk7IC8vIENvbnZlcnQgdG8gRGF0ZSBvYmplY3QKICAgICAgICBjb25zdCB0byA9IG5ldyBEYXRlKGRhdGUuZW5kRGF0ZSk7IC8vIENvbnZlcnQgdG8gRGF0ZSBvYmplY3QKCiAgICAgICAgLy8gQ3JlYXRlIGFuIGFycmF5IG9mIGRhdGVzIHdpdGhpbiB0aGUgJ2Zyb20nIGFuZCAndG8nIHJhbmdlCiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZShmcm9tKTsKICAgICAgICB3aGlsZSAoY3VycmVudERhdGUgPD0gdG8pIHsKICAgICAgICAgIGVuYWJsZWREYXRlcy5wdXNoKGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSk7CiAgICAgICAgICBjdXJyZW50RGF0ZS5zZXREYXRlKGN1cnJlbnREYXRlLmdldERhdGUoKSArIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgZGlzYWJsZV9kYXRlX2J5X3Nsb3QgPSB0aGlzLmRpc2FibGVfZGF0ZV9ieV9zbG90X2Z1bmMoKTsKCiAgICAgIHJldHVybiB7CiAgICAgICAgY3VzdG9tUHJlZGljdG9yOiBkYXRlID0+IHsKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTsgLy8gQ29udmVydCBkYXRlIHRvIGEgc3RyaW5nCiAgICAgICAgICAvLyBEaXNhYmxlIHBhc3QgZGF5cwogICAgICAgICAgaWYgKGRhdGUgPCB0b2RheSkgcmV0dXJuIHRydWU7CiAgICAgICAgICBpZiAodGhpcy5kYXRlX2NoZWNrZWQgPT0gZmFsc2UpIHsKICAgICAgICAgICAgaWYgKGRpc2FibGVfZGF0ZV9ieV9zbG90LmluY2x1ZGVzKGZvcm1hdHRlZERhdGUpKSB7CiAgICAgICAgICAgICAgdGhpcy5kYXRlX2NoZWNrZWQgPT0gdHJ1ZTsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIEVuYWJsZSB0b2RheSdzIGRhdGUgYW5kIGRhdGVzIHdpdGhpbiB0aGUgc3BlY2lmaWVkIGRhdGUgcmFuZ2UKICAgICAgICAgIHJldHVybiAhZW5hYmxlZERhdGVzLmluY2x1ZGVzKGZvcm1hdHRlZERhdGUpOwogICAgICAgIH0sCiAgICAgIH07CiAgICB9LAogICAgZGlzYWJsZV9kYXRlX2J5X3Nsb3RfZnVuYygpIHsKICAgICAgLy8gY29uc29sZS5sb2coJ0RJU0FCTEUgREFURSBCWSBTTE9UIEZVTkMgJykKICAgICAgY29uc3Qgc2VydmljZV9jYXRlZ29yeSA9IHRoaXMuc2VydmljZV9ieV9jYXRlZ29yeTsKICAgICAgY29uc29sZS5sb2coJ3NlcnZpY2VfYnlfY2F0ZWdvcnk6ICcsc2VydmljZV9jYXRlZ29yeSk7CiAgICAgIGxldCBkaXNhYmxlX2RhdGVfYnlfc2xvdCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZXJ2aWNlX2NhdGVnb3J5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzZXJ2aWNlX2NhdGVnb3J5W2ldLmNhcnRJdGVtVGFsbHkubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIC8vIFVzZSBmaW5kRGF0ZVJhbmdlSW5kZXggdG8gY2hlY2sgaWYgdGhlIGRhdGUgaXMgaW4gdGhlIHJhbmdlCiAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmZpbmREYXRlUmFuZ2VJbmRleChzZXJ2aWNlX2NhdGVnb3J5W2ldLnRpbWVTbG90LCBzZXJ2aWNlX2NhdGVnb3J5W2ldLmNhcnRJdGVtVGFsbHlbal0uZGF0ZSk7CiAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd0aGUgZGF0ZTogJywgc2VydmljZV9jYXRlZ29yeVtpXS5jYXJ0SXRlbVRhbGx5W2pdLmRhdGUsICcgZm91bmQgaW4gJywgc2VydmljZV9jYXRlZ29yeVtpXS50aW1lU2xvdFtpbmRleF0uc3RhcnREYXRlLHNlcnZpY2VfY2F0ZWdvcnlbaV0udGltZVNsb3RbaW5kZXhdLmVuZERhdGUpCiAgICAgICAgICAgIGxldCBjYXBhY2l0eSA9IHNlcnZpY2VfY2F0ZWdvcnlbaV0udGltZVNsb3RbaW5kZXhdLmNhcGFjaXR5OwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnY2FwYWNpdHkgPj0gc2VydmljZV9jYXRlZ29yeVtpXS5jYXJ0SXRlbVRhbGx5W2pdLmNvdW50JyxjYXBhY2l0eSA+PSBzZXJ2aWNlX2NhdGVnb3J5W2ldLmNhcnRJdGVtVGFsbHlbal0uY291bnQsY2FwYWNpdHksc2VydmljZV9jYXRlZ29yeVtpXS5jYXJ0SXRlbVRhbGx5W2pdLmNvdW50KQogICAgICAgICAgICBpZiAoc2VydmljZV9jYXRlZ29yeVtpXS5jYXJ0SXRlbVRhbGx5W2pdLmNvdW50ID49IGNhcGFjaXR5KSBkaXNhYmxlX2RhdGVfYnlfc2xvdC5wdXNoKHNlcnZpY2VfY2F0ZWdvcnlbaV0uY2FydEl0ZW1UYWxseVtqXS5kYXRlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gY29uc29sZS5sb2coJ2Rpc2FibGVfZGF0ZV9ieV9zbG90OiAnLGRpc2FibGVfZGF0ZV9ieV9zbG90KQogICAgICByZXR1cm4gZGlzYWJsZV9kYXRlX2J5X3Nsb3Q7CiAgICB9LAogICAgZm9ybWF0RGF0ZShkYXRlVG9QYXJzZSkgewogICAgICBjb25zdCBkYXRlQ29tcG9uZW50cyA9IGRhdGVUb1BhcnNlLnNwbGl0KCctJyk7CiAgICAgIGNvbnN0IHllYXIgPSBwYXJzZUludChkYXRlQ29tcG9uZW50c1swXSk7CiAgICAgIGNvbnN0IG1vbnRoID0gcGFyc2VJbnQoZGF0ZUNvbXBvbmVudHNbMV0pIC0gMTsKICAgICAgY29uc3QgZGF5ID0gcGFyc2VJbnQoZGF0ZUNvbXBvbmVudHNbMl0pOwogICAgICBjb25zdCBqc0RhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5ICsgMSk7CiAgICAgIHJldHVybiBqc0RhdGU7CiAgICB9LAogICAgZm9ybWF0TG9uZ0RhdGUoZGF0ZVN0cmluZykgewogICAgICBjb25zdCBkYXRlT2JqZWN0ID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7CgogICAgICAvLyBHZXQgdGhlIHllYXIsIG1vbnRoLCBhbmQgZGF5IGNvbXBvbmVudHMKICAgICAgY29uc3QgeWVhciA9IGRhdGVPYmplY3QuZ2V0RnVsbFllYXIoKTsKICAgICAgY29uc3QgbW9udGggPSAoZGF0ZU9iamVjdC5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAiMCIpOyAvLyBBZGRpbmcgMSBiZWNhdXNlIG1vbnRocyBhcmUgMC1iYXNlZAogICAgICBjb25zdCBkYXkgPSBkYXRlT2JqZWN0LmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIik7CgogICAgICAvLyBDcmVhdGUgdGhlICJZWVlZLU1NLUREIiBmb3JtYXR0ZWQgZGF0ZSBzdHJpbmcKICAgICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWA7CiAgICB9LAogICAgYXN5bmMgZ2V0X3NlcnZpY2VfYnlfY2F0ZWdvcnkoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdzZXJ2aWNlIGNhdGVnb3J5IGlkIGlzIG5vdycsIHRoaXMuc2VydmljZUNhdGVnb3J5SWQpCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRhcG9sbG8ucXVlcnkoewogICAgICAgICAgcXVlcnk6IHJlcXVpcmUoJ0AvZ3JhcGhxbC9TZXJ2aWNlQnlDYXRlZ29yeS5ncWwnKSwKICAgICAgICAgIHZhcmlhYmxlczogeyBpZDogcGFyc2VJbnQodGhpcy4kcm91dGUucGFyYW1zLmNhdGVnb3J5SWQpfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuc2VydmljZV9ieV9jYXRlZ29yeSA9IHJlc3BvbnNlLmRhdGEuc2VydmljZUJ5Q2F0ZWdvcnk7CiAgICAgICAgY29uc29sZS5sb2coJ2xpc3Qgb2Ygc2VydmljZSBieSBjYXRlZ29yeScsdGhpcy5zZXJ2aWNlX2J5X2NhdGVnb3J5KTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBsaWtlOicsIGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIGdldFNlcnZpY2VDYXRlZ29yeVVSTChpdGVtLCBpdGUpIHsKICAgICAgcmV0dXJuIGAvc2VydmljZV9jYXRlZ29yaWVzLyR7dGhpcy4kcm91dGUucGFyYW1zLmNhdGVnb3J5SWR9L3NlcnZpY2VzLyR7aXRlbS5pZH0vdGltZV9zbG90cy8ke2l0ZS5pZH1gOwogICAgfSwKICAgIGxvZ0N1cnJlbnRUaW1lKCkgewogICAgICBjb25zdCBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7CiAgICAgIGNvbnNvbGUubG9nKGBDdXJyZW50IHRpbWUgaXM6ICR7Y3VycmVudFRpbWV9YCk7CiAgICB9LAogICAgdGltZXNsb3RfaW5mb19ldmVudCgpIHsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgewogICAgICAvLyBjb25zdCBvZmZjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub2ZmY2FudmFzX3RpbWVzbG90X2luZm8nKTsKICAgICAgLy8gY29uc3QgdG9nZ2xlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZUJ1dHRvbicpOwoKICAgICAgLy8gdG9nZ2xlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7CiAgICAgIC8vICAgb2ZmY2FudmFzLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpOwogICAgICAvLyB9KTsKfSk7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5sb2dDdXJyZW50VGltZSgpOwogICAgdGhpcy5nZXRfc2VydmljZV9ieV9jYXRlZ29yeSgpOwogICAgdGhpcy50aW1lc2xvdF9pbmZvX2V2ZW50KCk7CiAgfSAKfQo="},{"version":3,"sources":["ServiceListCustomer.vue"],"names":[],"mappings":";AA0GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ServiceListCustomer.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"container\">\n    <!-- <div class=\"tooltip_custom\">Hover over me\n      <span class=\"tooltiptext_custom\">Tooltip text</span>\n    </div> -->\n    <!-- <h1>Services</h1> -->\n    <!-- <button @click=\"openModal\">Open Modal</button>\n    <button id=\"toggleButton\">Toggle Offcanvas</button> -->\n    <!-- Use the Modal component -->\n    <ModalTest :modalId=\"modalId\">\n      <!-- Customize the content using slots -->\n      <template v-slot:header>Custom Modal Header</template>\n      <template v-slot:body>Custom Modal Body</template>\n      <template v-slot:footer>\n        <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeModal\">Close</button>\n        <button type=\"button\" class=\"btn btn-primary\">Save changes</button>\n      </template>\n    </ModalTest>\n    <div v-if=\"err_notif\" class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\n      {{ err_message }} <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"></button>\n    </div>\n    <div class=\"row service_list_customer\">\n      <div class=\"col-md-6 service_list_customer_services\">\n        <div v-for=\"(item,index) in service_by_category\" :key=\"index\">\n          <div class=\"card service_box\">\n            <div class=\"row card-body service_item\" @mouseenter=\"showService(item)\">\n              <!-- <a class=\"service_link\" :href=\"generate_service_link(item.id)\"> -->\n              <h5>{{ item.name }}</h5>\n              <div class=\"col-md-4\">\n                <img v-if=\"calendar\" class=\"service_image\" :src=\"item.image\">\n                <img v-else class=\"service_image_whole\" :src=\"item.image\">\n                <!-- <p class=\"service_details\" v-if=\"!calendar\">{{ item.description }}</p> -->\n                <p class=\"service_details\" v-if=\"!calendar\">{{ formatToPHP(item.price) }}</p>\n              </div>\n              <!-- </a> -->\n              <div class=\"col-md-8\" v-if=\"calendar\">\n                <!-- :style=\"showTimeslotIndex === index ? 'display: block;' : 'display: none;'\" -->\n                <datepicker\n                  class=\"time\"\n                  :use-utc=\"true\"\n                  :disabled-dates=\"getDisabledDates(item.timeSlot)\"\n                  :day-cell-content=\"params => format_date(params)\"\n                  :inline=\"true\"\n                  @selected=\"params => handleDateSelected(params, item)\"\n                ></datepicker>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"col-md-6 hidden-sm hidden-xs service_list_customer_timeslot\">\n        <div class=\"offcanvas_timeslot_info\">\n          <h1 v-if=\"displayService != ''\">{{ displayService }}</h1>\n          <h1 v-else>{{ service_by_category[0].name }}</h1>\n          <form @submit.prevent=\"submitForm\" class=\"form-slot-picker\">\n            <div v-if=\"open_time == false\">\n              <p>Duration: {{ duration }}</p>\n              <p>Available Slot: {{ slot }}</p>\n              <div v-if=\"time == '' && available_timeslot.length > 0\">\n                <p>Available timeslot:</p>\n                <div class=\"scrollable-container\">\n                  <div class=\"scrollable-list\">\n                    <div v-for=\"(timeOption, index) in available_timeslot\" :key=\"index\">\n                      <label class=\"radio-label\">\n                        <input\n                          type=\"radio\"\n                          :value=\"timeOption.value\"\n                          v-model=\"time\"\n                          name=\"timeOption\"\n                          class=\"radio-input\"\n                        />\n                        {{ timeOption.label }}\n                      </label>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div v-else-if=\"time == '' && available_timeslot.length <= 0\">\n                <p v-if=\"maxTime != ''\">No open time slots on this day.</p>\n                <p v-else>Select a date for your appointment.</p>\n              </div>\n              <div v-else>\n                <p v-if=\"time != ''\" @click.prevent=\"changeTime\">Selected Time: {{ time }}</p>\n              </div>\n            </div>\n            <div v-else>\n              <p>Available Slot: {{ slot > 50 ? 50 : slot }}</p>\n              <p v-if=\"minTime != '' && maxTime != ''\">Select time from {{ minTime }} to {{ maxTime }}</p>\n              <vue2-timepicker \n                v-model=\"time\"\n                :hour-range=\"[[startHour(), endHour()]]\"\n                lazy\n                hide-clear-button\n                @change=\"onTimeSelected()\"\n              />\n              <p v-if=\"time != ''\">Selected Time: {{ time }}</p>\n            </div>\n            <input v-if=\"time != ''\" type=\"submit\" value=\"submit\">\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { required, helpers } from '@vuelidate/validators';\nimport { useVuelidate } from '@vuelidate/core'\nimport ModalTest from '@/components/ModalTest.vue';\nimport Datepicker from 'vuejs-datepicker';\nimport Vue2Timepicker from 'vue2-timepicker';\nexport default {\n  name: 'ServiceListCustomer',\n  setup () { return { v$: useVuelidate() } },\n  data() {\n    return {\n      service_by_category: [],\n      modalId: 'customModal',\n      available_timeslot: [],\n      duration: 0,\n      date: '',\n      open_time: false,\n      minTime: 0,\n      maxTime: 0,\n      time: '',\n      convertedTime: '',\n      service_id: '',\n      service: [],\n      slot: 0,\n      err_message: '',\n      err_notif: false,\n      date_checked: false,\n      calendar: true,\n      showCalendarIndex: 0,\n      displayService: '',\n    }\n  },\n  validations() {\n    const min_time = value => {\n      const selectedTime = new Date(`1970-01-01T${this.convertTo24HourFormat(value)}`);\n      console.log('min_time val: ', value, this.minTime)\n      const mintime = new Date(`1970-01-01T${this.convertTo24HourFormat(this.minTime)}`);\n      console.log('min_time result: ', selectedTime >= mintime)\n      return selectedTime >= mintime;\n    };\n    const max_time = value => {\n      const selectedTime = new Date(`1970-01-01T${this.convertTo24HourFormat(value)}`);\n      console.log('max_time val: ', value, this.maxTime)\n      const maxtime = new Date(`1970-01-01T${this.convertTo24HourFormat(this.maxTime)}`);\n      console.log('max_time result: ', selectedTime <= maxtime)\n      return selectedTime <= maxtime;\n    };\n    return {\n      time: {\n        required,\n        // validTime(value) {\n        //   const timePattern = /^([01]\\d|2[0-3]):([0-5]\\d)$/;\n        //   return timePattern.test(value);\n        // },\n        min_time: helpers.withMessage('The min time must be ' + this.minTime, min_time) ,     \n        max_time: helpers.withMessage('The max time must be ' + this.maxTime, max_time) ,     \n      },\n    }\n  },\n  components: {\n    Datepicker,\n    ModalTest,\n    Vue2Timepicker,\n  },\n  methods: {\n    showService(item) {\n      console.log('showService')\n      this.available_timeslot = 0\n      this.time = ''\n      this.maxTime = ''\n      this.minTime = ''\n      this.displayService = item.name\n      history.pushState(\n        {},\n        null,\n        this.$route.path + '/services/' + encodeURIComponent(item.id)\n      )\n    },\n    showCalendar(index) {\n      this.calendar = true;\n      this.showCalendarIndex = index;\n      console.log('showCalendar', index);\n    },\n    hideCalendar() {\n      this.calendar = false;\n      console.log('hide calendar')\n    },\n    isTimeInFormat() {\n      const timePattern = /^(0[1-9]|1[0-2]):[0-5][0-9]:[0-5][0-9] (AM|PM)$/;\n      return timePattern.test(this.time);\n    },\n    async create_cart_item() {\n      try {\n        const date = this.date;\n        const service_id = this.service.id;\n        const time = this.time;\n        console.log('serviceid is ', service_id)\n        console.log('date ', date);\n        console.log('time ', time)\n\n        const response = await this.$apollo.mutate({\n          mutation: require('@/graphql/CartItemCreate.gql'),\n          variables: {\n            serviceId: service_id,\n            date: date,\n            time: time,\n          },\n        });\n        console.log('response from server create cart item',response);\n        if (response.data.createCartItem.errors.length < 1) {\n          alert('SUCCESS !')\n          // this.$router.push('/cart')\n        } else {\n          this.handleError(response.data.createCartItem.errors[0]);\n        }\n      } catch (error) {\n        console.error('Error in create_cart_item:', error);\n        // Handle the error here, e.g., show an error message to the user.\n      }\n    },\n    handleError(errMsg) {\n      this.err_message = errMsg;\n      this.err_notif = true;\n      setTimeout(() => this.err_notif = false, 10000);\n    },\n    onTimeSelected() {\n      if (this.time > this.maxTime) this.time = this.maxTime;\n      this.time = this.convertTo12HourFormat(this.time);\n    },\n    changeTime() { this.time = '' },\n    convertTo24HourFormat(time12) {\n      // Split the input time into hours, minutes, and AM/PM parts\n      const [timePart, ampm] = time12.split(' ');\n      const [hours, minutes, seconds] = timePart.split(':');\n\n      // Parse the hours as an integer\n      let convertedHours = parseInt(hours, 10);\n\n      // Adjust the hours based on AM or PM\n      if (ampm.toUpperCase() === 'PM' && convertedHours !== 12) {\n        convertedHours += 12;\n      } else if (ampm.toUpperCase() === 'AM' && convertedHours === 12) {\n        convertedHours = 0;\n      }\n      // Create the 24-hour format time string\n      const convertedTime = `${String(convertedHours).padStart(2, '0')}:${minutes}:${seconds}`;\n\n      return convertedTime;\n    },\n    convertTo12HourFormat(time24) {\n      const [hours, minutes] = time24.split(\":\");\n      let ampm = \"AM\";\n      let convertedHours = parseInt(hours, 10);\n      if (convertedHours >= 12) {\n        ampm = \"PM\";\n        if (convertedHours > 12) {\n          convertedHours -= 12;\n        }\n      } else if (convertedHours === 0) {\n        convertedHours = 12; // Midnight in 12-hour format is 12:00 AM\n      }\n      const new_time = `${String(convertedHours).padStart(2, \"0\")}:${minutes}:00 ${ampm}`;\n      return new_time;\n    },\n    getCurrentHour() {\n      const currentDate = new Date();\n      const currentHour = currentDate.getHours();\n\n      return parseInt(currentHour);\n    },\n    startHour(){\n      if (this.date == this.dateToday()) {\n        const hour = this.getCurrentHour();\n        if (hour >= parseInt(this.minTime.split(\":\")[0], 10)) return hour + 1;\n      } else {\n        return parseInt(this.minTime.split(\":\")[0], 10);\n      }\n    },\n    endHour(){\n      return parseInt(this.maxTime.split(\":\")[0], 10);\n    },\n    async submitForm() {\n      this.minTime = this.convertTo12HourFormat(this.minTime);\n      this.maxTime = this.convertTo12HourFormat(this.maxTime);\n      this.v$.time.$touch();\n      if (this.v$.$error) {\n        console.log('error');\n        console.log('error time: ', this.time);\n        console.log('errormsg: ', this.v$.$errors);\n      } else {\n        await this.create_cart_item();\n      }\n      this.minTime = this.convertTo24HourFormat(this.minTime);\n      this.maxTime = this.convertTo24HourFormat(this.maxTime);\n      const time24 = this.time.trim();\n      if (time24.match(/^\\d{2}:\\d{2}$/)) {\n        this.convertedTime = this.convertTo12HourFormat(time24);\n      }\n      console.log('UPDATED TIME: ',this.convertedTime);\n    },\n    handleDateSelected(params, item) {\n      let range = item.timeSlot[this.findDateRangeIndex(item.timeSlot, params)];\n        // console.log('timeslot info is: ', range);\n      this.minTime = range.startTime;\n      this.maxTime = range.endTime;\n      this.duration = range.duration;\n      console.log('SELECTED DATE: ', params)\n\n      let booked_counter = 0;\n      for (let i=0; i<item.cartItem.length; i++) {\n        if(this.timestampTodate(params) == item.cartItem[i].date) booked_counter++;\n      }\n      this.slot = range.capacity - booked_counter;\n      console.log('remaining slot for date: ',this.timestampTodate(params), ' is: ', this.slot)\n\n      console.log('range: ',range);\n      if (range.duration !== null) {\n        this.open_time = false;\n        this.time = '';\n        this.available_timeslot = this.createAvailableTimeSlot(range.startTime, range.endTime, range.duration, range.interval, params, item.cartItem)\n      } else {\n        this.open_time = true;\n      }\n      // This method will be called when a date is selected\n      this.date = params;\n      this.service = item;\n      console.log('Selected date:', params, item);\n    },\n    findDateRangeIndex(dateRanges, targetDate) {\n      const date = new Date(targetDate); // Convert targetDate to a Date object\n      for (let i = 0; i < dateRanges.length; i++) {\n        const { startDate, endDate } = dateRanges[i];\n\n        if (date >= new Date(startDate) && date <= new Date(endDate)) {\n          return i; // Return the index if the date is within the range\n        }\n      }\n      return -1; // Return -1 if the date is not found in any range\n    },\n    dateToday() {\n      // Create a Date object with the desired date (e.g., the current date)\n      const currentDate = new Date();\n\n      // Get the day, month, and year components\n      const day = currentDate.getDate(); // 1-31\n      const month = currentDate.getMonth() + 1; // 0-11 (January is 0, so add 1)\n      const year = currentDate.getFullYear(); // 4-digit year\n      const formattedDay = String(day).padStart(2, '0');\n      const formattedMonth = String(month).padStart(2, '0');\n      return `${year}-${formattedMonth}-${formattedDay}`;\n    },\n    format_date(params) {\n      return params.date\n    },\n    createAvailableTimeSlot(start_time_str, end_time_str, duration, interval, date_selected, item) {\n      const date_selected_formatted = this.formatLongDate(date_selected);\n      const hour = this.getCurrentHour();\n      let edited_start_time = 0;\n      if (this.dateToday() == date_selected_formatted) {\n        const timeComponents = start_time_str.split(\":\");\n        // Extract the hour component (the first element after splitting)\n        const selectedHour = parseInt(timeComponents[0], 10);\n        if (hour >= selectedHour) {\n          console.log(hour >= start_time_str, 'HOUR')\n          edited_start_time = `${hour + 1}:00:00`;\n        }\n      }\n      console.log('edited_start_time',edited_start_time)\n      console.log(this.dateToday() == date_selected_formatted,this.dateToday(),date_selected_formatted)\n      if (duration == null) duration = 0;\n      const availableTimeSlots = [];\n      const startTime = edited_start_time == 0 ? this.parseTime(start_time_str) : this.parseTime(edited_start_time);\n      console.log('startTime: ', startTime, 'this.parseTime(start_time_str): ', this.parseTime(start_time_str))\n      const endTime = this.parseTime(end_time_str);\n\n      let currentTime = new Date(startTime);\n\n      while (currentTime <= endTime) {\n        availableTimeSlots.push({value: this.formatTime(currentTime), label: this.formatTime(currentTime)});\n        currentTime = this.addMinutes(currentTime, duration); // Increment by duration, not interval\n        currentTime = this.addMinutes(currentTime, interval); // Add the remaining interval\n      }\n      \n      const dateObject = new Date(date_selected);\n      let new_timeslot = [];\n      // Format it as a date string\n      const formattedDate = dateObject.toISOString().split('T')[0];\n      for (let i=0; i<item.length; i++) {\n        if (item[i].date == formattedDate) {\n          const dateObject = new Date(item[i].time);\n\n          // Format it as a time string\n          // Create an Intl.DateTimeFormat object with the desired time zone\n          const formatter = new Intl.DateTimeFormat('en-US', {\n            hour: 'numeric',\n            minute: 'numeric',\n            second: 'numeric',\n            timeZone: 'UTC' // Set the desired time zone\n          });\n\n          // Format the date object\n          const timeString = formatter.format(dateObject);\n          new_timeslot = availableTimeSlots.filter(item => item.value !== timeString);\n\n        }\n      }\n      console.log('available timeslot: ', availableTimeSlots);      \n      console.log('new_timeslot',new_timeslot)\n      return new_timeslot.length > 0 ? new_timeslot : availableTimeSlots;\n    },\n    parseTime(timeStr) {\n      const [hours, minutes] = timeStr.split(':').map(Number);\n      const date = new Date();\n      date.setHours(hours, minutes, 0, 0);\n      return date;\n    },\n    formatTime(time) {\n      return time.toLocaleTimeString('en-US', { hour12: true });\n    },\n    addMinutes(time, minutes) {\n      return new Date(time.getTime() + minutes * 60000);\n    },\n    handleScroll(event) {\n      const element = event.target;\n      const scrollSpeed = 100; // Adjust this value to control scrolling speed\n\n      if (event.deltaY !== 0) {\n        // Prevent vertical scrolling\n        event.preventDefault();\n\n        // Calculate the horizontal scroll amount based on scroll speed and scroll direction\n        const scrollAmount = event.deltaY > 0 ? scrollSpeed : -scrollSpeed;\n\n        // Scroll horizontally\n        element.scrollLeft += scrollAmount;\n      }\n    },\n    openModal() {\n      // Use JavaScript to open the modal\n      const modal = document.getElementById(this.modalId);\n      modal.classList.add('show');\n      modal.style.display = 'block';\n      modal.setAttribute('aria-hidden', 'false');\n\n      const modalBackdrop = document.createElement('div');\n      modalBackdrop.classList.add('modal-backdrop', 'fade', 'show');\n      document.body.appendChild(modalBackdrop);\n    },\n    closeModal() {\n      const modal = document.getElementById(this.modalId);\n      modal.classList.remove('show');\n      modal.style.display = 'none';\n      modal.setAttribute('aria-hidden', 'true');\n\n      const modalBackdrop = document.querySelector('.modal-backdrop');\n      modalBackdrop.remove();\n    },\n    generate_service_link(service_id) {\n      return `/service_categories/${this.$route.params.categoryId}/services/${service_id}`;\n    },\n    formatToPHP(number) {\n      // Convert the number to a string with two decimal places\n      const formattedNumber = Number(number).toFixed(2);\n\n      // Add \"PHP \" to the formatted number and use commas as a thousands separator\n      const result = `PHP ${formattedNumber.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ', ')}`;\n\n      return result;\n    },\n    timestampTodate(timestamp) {\n      const date = new Date(timestamp);\n      // Extract the components (month, day, year)\n      const month = (date.getMonth() + 1).toString().padStart(2, '0'); // Add 1 because months are zero-indexed\n      const day = date.getDate().toString().padStart(2, '0');\n      const year = date.getFullYear();\n\n      // Format the date as MM-DD-YYYY\n      return `${year}-${month}-${day}`;\n    }, \n    getDisabledDates(dates) {\n      let enabledDates = [];\n      const today = new Date(); // Get today's date as a Date object\n\n      for (const date of dates) {\n        const from = new Date(date.startDate); // Convert to Date object\n        const to = new Date(date.endDate); // Convert to Date object\n\n        // Create an array of dates within the 'from' and 'to' range\n        const currentDate = new Date(from);\n        while (currentDate <= to) {\n          enabledDates.push(currentDate.toISOString().split('T')[0]);\n          currentDate.setDate(currentDate.getDate() + 1);\n        }\n      }\n\n      const disable_date_by_slot = this.disable_date_by_slot_func();\n\n      return {\n        customPredictor: date => {\n          const formattedDate = date.toISOString().split('T')[0]; // Convert date to a string\n          // Disable past days\n          if (date < today) return true;\n          if (this.date_checked == false) {\n            if (disable_date_by_slot.includes(formattedDate)) {\n              this.date_checked == true;\n              return true;\n            }\n          }\n\n          // Enable today's date and dates within the specified date range\n          return !enabledDates.includes(formattedDate);\n        },\n      };\n    },\n    disable_date_by_slot_func() {\n      // console.log('DISABLE DATE BY SLOT FUNC ')\n      const service_category = this.service_by_category;\n      console.log('service_by_category: ',service_category);\n      let disable_date_by_slot = [];\n\n      for (let i = 0; i < service_category.length; i++) {\n        for (let j = 0; j < service_category[i].cartItemTally.length; j++) {\n          // Use findDateRangeIndex to check if the date is in the range\n          let index = this.findDateRangeIndex(service_category[i].timeSlot, service_category[i].cartItemTally[j].date);\n          if (index !== -1) {\n            // console.log('the date: ', service_category[i].cartItemTally[j].date, ' found in ', service_category[i].timeSlot[index].startDate,service_category[i].timeSlot[index].endDate)\n            let capacity = service_category[i].timeSlot[index].capacity;\n            // console.log('capacity >= service_category[i].cartItemTally[j].count',capacity >= service_category[i].cartItemTally[j].count,capacity,service_category[i].cartItemTally[j].count)\n            if (service_category[i].cartItemTally[j].count >= capacity) disable_date_by_slot.push(service_category[i].cartItemTally[j].date);\n          }\n        }\n      }\n      // console.log('disable_date_by_slot: ',disable_date_by_slot)\n      return disable_date_by_slot;\n    },\n    formatDate(dateToParse) {\n      const dateComponents = dateToParse.split('-');\n      const year = parseInt(dateComponents[0]);\n      const month = parseInt(dateComponents[1]) - 1;\n      const day = parseInt(dateComponents[2]);\n      const jsDate = new Date(year, month, day + 1);\n      return jsDate;\n    },\n    formatLongDate(dateString) {\n      const dateObject = new Date(dateString);\n\n      // Get the year, month, and day components\n      const year = dateObject.getFullYear();\n      const month = (dateObject.getMonth() + 1).toString().padStart(2, \"0\"); // Adding 1 because months are 0-based\n      const day = dateObject.getDate().toString().padStart(2, \"0\");\n\n      // Create the \"YYYY-MM-DD\" formatted date string\n      return `${year}-${month}-${day}`;\n    },\n    async get_service_by_category() {\n      console.log('service category id is now', this.serviceCategoryId)\n      try {\n        const response = await this.$apollo.query({\n          query: require('@/graphql/ServiceByCategory.gql'),\n          variables: { id: parseInt(this.$route.params.categoryId)}\n        });\n        this.service_by_category = response.data.serviceByCategory;\n        console.log('list of service by category',this.service_by_category);\n      } catch (error) {\n        console.error('Error creating like:', error);\n      }\n    },\n    getServiceCategoryURL(item, ite) {\n      return `/service_categories/${this.$route.params.categoryId}/services/${item.id}/time_slots/${ite.id}`;\n    },\n    logCurrentTime() {\n      const currentTime = new Date().toLocaleTimeString();\n      console.log(`Current time is: ${currentTime}`);\n    },\n    timeslot_info_event() {\n      document.addEventListener('DOMContentLoaded', function() {\n      // const offcanvas = document.querySelector('.offcanvas_timeslot_info');\n      // const toggleButton = document.getElementById('toggleButton');\n\n      // toggleButton.addEventListener('click', function() {\n      //   offcanvas.classList.toggle('active');\n      // });\n});\n    }\n  },\n  mounted() {\n    this.logCurrentTime();\n    this.get_service_by_category();\n    this.timeslot_info_event();\n  } \n}\n</script>\n\n<style>\n.date_link {\n  text-decoration: none;\n}\n\n.date_num {\n  /* background-color: red; */\n  padding: 5px;\n}\n\nh5 {\n  font-family: Verdana, Geneva, Tahoma, sans-serif;\n  font-weight: bolder;\n  position: relative;\n  /* margin-bottom: 230px; */\n  /* margin-top: 220px; */\n  z-index: 2;\n  /* background-color: rgba(255, 255, 255, 0.5);  */\n}\n\n.service_list_customer {\n  /* border: 1px solid gray; */\n}\n\n.service_list_customer_timeslot {\n  position: sticky;\n  top: 0; /* Stick to the top of the parent container */ /* Occupy the full viewport height */\n  height: 95vh;\n}\n\n.test_customer_service {\n  display: inline-block;\n  white-space: nowrap !important;\n  margin-right: 40px;\n}\n\n/* Add your CSS styles for .service_list_customer_services here */\n.service_list_customer_services {\n  padding-bottom: 17px; /* Adjust for scrollbar height */\n  max-width: 100%; /* Ensure it takes up the available width */\n  height: 100%; /* Optionally, set a fixed height or use flexbox for layout */\n}\n\n.service_link {\n  text-decoration: none;\n  color:rgb(14, 12, 12);\n}\n\n.service_box, .service_item {\n  margin: 20px 0 0 auto;\n  width: 100%;\n}\n\n.service_item p {\n  font-weight: bold;\n  white-space: wrap;\n}\n\n.service_details {\n  z-index: 2;\n}\n\n.service_image {\n  opacity: .65;\n  z-index: 1;\n  border-radius: 5px 5px 0 0;\n  max-width: 100%; /* Ensure the image scales down proportionally */\n  height: 50%;    /* Maintain the aspect ratio */\n  width: 100%;    /* Set a maximum width if needed */\n  max-height: 300px;\n}\n\n.service_image_whole {\n  height: 200px;\n  top: 0;\n  opacity: .65;\n  z-index: 1;\n  border-radius: 5px 5px 0 0;\n  max-width: 100%; /* Ensure the image scales down proportionally */    /* Maintain the aspect ratio */\n  width: 100%;    /* Set a maximum width if needed */\n}\n\n.form-slot-picker {\n  min-height: 300px;\n}\n\n.scrollable-list {\n  max-height: 100%; /* Allow the list to take the full height of the container */\n  overflow-y: auto;\n  border: 1px solid #ccc; /* Optional: Add a border for styling */\n  padding: 10px; /* Optional: Add padding for spacing */\n}\n\n.scrollable-container {\n  /* Hide any overflow outside of the container */\n  max-height: 100%;\n  overflow: hidden;\n}\n\n.offcanvas_timeslot_info {\n  max-height: 100%; /* Allow the container to take the full height of the parent */\n  margin-top: 20px;\n  /* width: 250px; */\n  width: 100%;\n  background-color: #fff;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);\n  transition: left 0.3s;\n  z-index: 1;\n  overflow-y: auto;\n}\n\n.offcanvas_timeslot_info.active {\n  left: 0; /* Slide in from left */\n}\n\n/* Style for the radio label */\n.radio-label {\n  position: relative;\n  padding-left: 30px; /* Adjust the padding to your preference */\n  padding-bottom: 10px; /* Add margin between options */\n  cursor: pointer;\n}\n\n/* Style for the radio input (hide the default radio button) */\n.radio-input {\n  opacity: 0;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n/* Style for the border when the radio input is checked */\n.radio-label::before {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 0;\n  transform: translateY(-50%);\n  width: 20px; /* Adjust the border width */\n  height: 20px; /* Adjust the border height */\n  border: 2px solid transparent; /* Define the border color and thickness */\n  border-radius: 50%; /* Create a circle border */\n  background-color: transparent; /* Remove background color */\n}\n\n/* Style for the border when the radio input is checked */\n.radio-input:checked + .radio-label::before {\n  border-color: #007bff; /* Define the border color when checked */\n}\n\n/* Increase font size by 5px on hover */\n.radio-label:hover {\n  font-size: calc(1em + 5px); /* Increase font size by 5px */\n}\n\n.tooltip_custom {\n  position: relative;\n}\n\n.tooltiptext_custom {\n  visibility: hidden;\n  width: 120px;\n  background-color: black;\n  color: #fff;\n  text-align: center;\n  border-radius: 6px;\n  padding: 5px 0;\n\n  /* Position the tooltip */\n  position: absolute;\n  z-index: 1;\n}\n\n.tooltip_custom:hover .tooltiptext_custom {\n  visibility: visible;\n}\n</style>\n"]}]}