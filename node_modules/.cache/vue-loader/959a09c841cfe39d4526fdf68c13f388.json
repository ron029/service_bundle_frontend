{"remainingRequest":"/home/bonifacio/code/service_bundle_frontend/node_modules/@vue/cli-service/lib/config/vue-loader-v15-resolve-compat/vue-loader.js??vue-loader-options!/home/bonifacio/code/service_bundle_frontend/src/views/BookingManager.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/bonifacio/code/service_bundle_frontend/src/views/BookingManager.vue","mtime":1694263906875},{"path":"/home/bonifacio/code/service_bundle_frontend/node_modules/babel-loader/lib/index.js","mtime":1692833949708},{"path":"/home/bonifacio/code/service_bundle_frontend/node_modules/cache-loader/dist/cjs.js","mtime":1692838039149},{"path":"/home/bonifacio/code/service_bundle_frontend/node_modules/@vue/cli-service/lib/config/vue-loader-v15-resolve-compat/vue-loader.js","mtime":1692833961693}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQm9va2luZ01hbmFnZXInLAogIGRhdGEoKXsKICAgIHJldHVybiB7CiAgICAgIGhpc3Rvcnk6IFtdCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBhY3Rpb25faXRlbShpdGVtLCBhY3Rpb24pIHsKICAgICAgY29uc29sZS5sb2coaXRlbSwgYWN0aW9uKQogICAgICBsZXQgc3RhdHVzID0gMDsKICAgICAgaWYgKGFjdGlvbiA9PSAnY2FuY2VsbGVkJykgc3RhdHVzID0gMwogICAgICBpZiAoYWN0aW9uID09ICdjb21wbGV0ZWQnKSBzdGF0dXMgPSA0CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kYXBvbGxvLm11dGF0ZSh7CiAgICAgICAgbXV0YXRpb246IHJlcXVpcmUoJ0AvZ3JhcGhxbC9VcGRhdGVTdGF0dXNBZG1pbkNhcnRJdGVtLmdxbCcpLAogICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgaWQ6IHBhcnNlSW50KGl0ZW0uaWQpLAogICAgICAgICAgc3RhdHVzOiBzdGF0dXMKICAgICAgICB9CiAgICAgIH0pCiAgICAgIGlmIChyZXNwb25zZSkgewogICAgICAgIGFsZXJ0KCdUaGUgaXRlbSBpZDogJyArIGl0ZW0uaWQgKyAnIGhhcyBiZWVuICcgKyBhY3Rpb24gKQogICAgICAgIHRoaXMucmVsb2FkUGFnZSgpCiAgICAgIH0KICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpCiAgICB9LAogICAgYXN5bmMgYm9va2luZ19kZXRhaWxzKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kYXBvbGxvLnF1ZXJ5KHsKICAgICAgICAgIHF1ZXJ5OiByZXF1aXJlKCdAL2dyYXBocWwvQm9va2luZ0hpc3RvcnkuZ3FsJyksCiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpCiAgICAgICAgdGhpcy5oaXN0b3J5ID0gcmVzcG9uc2UuZGF0YS5ib29raW5nRGV0YWlscwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZV9zZXJ2aWNlOicsIGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIGdldFN0YXR1c0xhYmVsKGl0ZW0pIHsKICAgICAgY29uc3Qgc3RhdHVzTWFwID0geyBwZW5kaW5nOiAwLCBwYWlkOiAxLCBjb25maXJtZWQ6IDIsIGNhbmNlbGxlZDogMywgY29tcGxldGVkOiA0IH07CiAgICAgIGNvbnN0IHN0YXR1c0xhYmVsID0gT2JqZWN0LmtleXMoc3RhdHVzTWFwKS5maW5kKGtleSA9PiBzdGF0dXNNYXBba2V5XSA9PT0gcGFyc2VJbnQoaXRlbS5zdGF0dXMpKTsKICAgICAgcmV0dXJuIHN0YXR1c0xhYmVsIHx8ICdVbmtub3duJzsgLy8gRmFsbGJhY2sgZm9yIHVua25vd24gc3RhdHVzCiAgICB9LAogICAgcmVsb2FkUGFnZSgpIHsKICAgICAgLy8gUmVsb2FkIHRoZSBjdXJyZW50IHBhZ2UKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmJvb2tpbmdfZGV0YWlscygpCiAgfQp9Cg=="},{"version":3,"sources":["BookingManager.vue"],"names":[],"mappings":";AAyFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BookingManager.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"container\">\n    <h1>Booking History</h1>\n    <ul class=\"nav nav-tabs\" id=\"myTab\" role=\"tablist\">\n      <li class=\"nav-item\" role=\"presentation\">\n        <button class=\"nav-link active\" id=\"home-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#home-tab-pane\" type=\"button\" role=\"tab\" aria-controls=\"home-tab-pane\" aria-selected=\"true\">Booking</button>\n      </li>\n      <li class=\"nav-item\" role=\"presentation\">\n        <button class=\"nav-link\" id=\"profile-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#profile-tab-pane\" type=\"button\" role=\"tab\" aria-controls=\"profile-tab-pane\" aria-selected=\"false\">Bookings History</button>\n      </li>\n    </ul>\n    <div class=\"tab-content\" id=\"myTabContent\">\n      <div class=\"tab-pane fade show active\" id=\"home-tab-pane\" role=\"tabpanel\" aria-labelledby=\"home-tab\" tabindex=\"0\">\n        <table class=\"table\">\n          <thead>\n            <tr>\n              <td>id</td>\n              <td>bookingId</td>\n              <td>cartDate</td>\n              <td>serviceCategories</td>\n              <td>services</td>\n              <td>nameOfCustomer</td>\n              <td>date</td>\n              <td>time</td>\n              <td>amount</td>\n              <td>status</td>\n              <td>action</td>\n            </tr>\n          </thead>\n          <tbody>\n            <template v-if=\"history\">\n              <tr v-for=\"item in history\" :key=\"item.id\">\n                <td>{{ item.id }}</td>\n                <td>{{ item.bookingId }}</td>\n                <td>{{ item.cartDate }}</td>\n                <td>{{ item.serviceCategories }}</td>\n                <td>{{ item.services }}</td>\n                <td>{{ item.nameOfCustomer }}</td>\n                <td>{{ item.date }}</td>\n                <td>{{ item.time }}</td>\n                <td>{{ item.amount }}</td>\n                <td>{{ getStatusLabel(item) }}</td>\n                <td>\n                  <button :disabled=\"parseInt(item.status)!==1 && parseInt(item.status)!==0\" @click=\"action_item(item, 'completed')\" class=\"btn btn-success\">complete</button>\n                  <button :disabled=\"parseInt(item.status)!==1 && parseInt(item.status)!==0\" @click=\"action_item(item, 'cancelled')\" class=\"btn btn-danger\">cancelled</button>\n                </td>\n              </tr>\n            </template>\n            <template v-else><tr><td colspan=\"11\">No items available.</td></tr></template>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"tab-pane fade show active\" id=\"profile-tab-pane\" role=\"tabpanel\" aria-labelledby=\"profile-tab\" tabindex=\"0\">\n        <table class=\"table\">\n          <thead>\n            <tr>\n              <td>id</td>\n              <td>bookingId</td>\n              <td>cartDate</td>\n              <td>serviceCategories</td>\n              <td>services</td>\n              <td>nameOfCustomer</td>\n              <td>date</td>\n              <td>time</td>\n              <td>amount</td>\n              <td>status</td>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"item in history\" :key=\"item.id\">\n              <td>{{ item.id }}</td>\n              <td>{{ item.bookingId }}</td>\n              <td>{{ item.cartDate }}</td>\n              <td>{{ item.serviceCategories }}</td>\n              <td>{{ item.services }}</td>\n              <td>{{ item.nameOfCustomer }}</td>\n              <td>{{ item.date }}</td>\n              <td>{{ item.time }}</td>\n              <td>{{ item.amount }}</td>\n              <td>{{ getStatusLabel(item) }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'BookingManager',\n  data(){\n    return {\n      history: []\n    }\n  },\n  methods: {\n    async action_item(item, action) {\n      console.log(item, action)\n      let status = 0;\n      if (action == 'cancelled') status = 3\n      if (action == 'completed') status = 4\n      const response = await this.$apollo.mutate({\n        mutation: require('@/graphql/UpdateStatusAdminCartItem.gql'),\n        variables: {\n          id: parseInt(item.id),\n          status: status\n        }\n      })\n      if (response) {\n        alert('The item id: ' + item.id + ' has been ' + action )\n        this.reloadPage()\n      }\n      console.log(response)\n    },\n    async booking_details() {\n      try {\n        const response = await this.$apollo.query({\n          query: require('@/graphql/BookingHistory.gql'),\n        });\n        console.log(response)\n        this.history = response.data.bookingDetails\n      } catch (error) {\n        console.error('Error in update_service:', error);\n      }\n    },\n    getStatusLabel(item) {\n      const statusMap = { pending: 0, paid: 1, confirmed: 2, cancelled: 3, completed: 4 };\n      const statusLabel = Object.keys(statusMap).find(key => statusMap[key] === parseInt(item.status));\n      return statusLabel || 'Unknown'; // Fallback for unknown status\n    },\n    reloadPage() {\n      // Reload the current page\n      window.location.reload();\n    },\n  },\n  mounted() {\n    this.booking_details()\n  }\n}\n</script>\n\n<style>\n\n</style>\n"]}]}